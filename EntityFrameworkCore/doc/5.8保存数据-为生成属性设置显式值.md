#### 为生成属性设置显式值 - Setting Explicit Values for Generated Properties

生成属性就是在添加和/或更新实体时生成其值的属性。查看[生成属性](2.5生成值.md)获取更多信息。

在某些情况下，可能为生成属性设置显示的值，而不是生成一个值。

##### 模型

这篇文章中使用的模型包含一个`Employee`实体。

```csharp
public class Employee
{
    public int EmployeeId { get; set; }
    public string Name { get; set; }
    public DateTime EmploymentStarted { get; set; }
    public int Salary { get; set; }
    public DateTime? LastPayRaise { get; set; }
}
```

##### 在添加过程中保存一个显示的值

`Employee.EmploymentStarted`属性配置为由数据库为新实体生成值(使用默认值)

```csharp
modelBuilder.Entity<Employee>()
    .Property(b => b.EmploymentStarted)
    .HasDefaultValueSql("CONVERT(date, GETDATE())");
```

下面的代码插入两个employees到数据库：
* 对于第一个，没有为属性`Employee.EmploymentStarted`指定值，因此，它仍然被设置为`DateTime`的CLR默认值
* 对于第二个，设置显式值`1-Jan-2000`

```csharp
using (var context = new EmployeeContext())
{
    context.Employees.Add(new Employee { Name = "John Doe" });
    context.Employees.Add(new Employee { Name = "Jane Doe", EmploymentStarted = new DateTime(2000, 1, 1) });
    context.SaveChanges();

    foreach (var employee in context.Employees)
    {
        Console.WriteLine(employee.EmployeeId + ": " + employee.Name + ", " + employee.EmploymentStarted);
    }
}
```

输出展示数据库为第一个employee生成一个值，显示值用于第二个employee

```
1: John Doe, 1/26/2017 12:00:00 AM
2: Jane Doe, 1/1/2000 12:00:00 AM
```

###### 显示值放入SQL Server IDENTITY列

按照约定，`Employee.EmployeeId`属性是一个存储生成`IDENTITY`列。

对于大多数情况，上面所示的方法适用于键属性。然而，要插入显式值到SQL server`IDENTITY`列，需要在调用`SaveChanges()`之前手动使能`IDENTITY_INSERT`。

>**Note**
>
>

```csharp
using (var context = new EmployeeContext())
{
    context.Employees.Add(new Employee { EmployeeId = 100, Name = "John Doe" });
    context.Employees.Add(new Employee { EmployeeId = 101, Name = "Jane Doe" });

    context.Database.OpenConnection();
    try
    {
        context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT dbo.Employees ON");
        context.SaveChanges();
        context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT dbo.Employees OFF");
    }
    finally
    {
        context.Database.CloseConnection();
    }


    foreach (var employee in context.Employees)
    {
        Console.WriteLine(employee.EmployeeId + ": " + employee.Name);
    }
}
```
