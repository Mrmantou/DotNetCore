#### 保存关联数据

除了单独的实体，还可以使用模型中定义的关联关系。

##### 添加一个图表新实体 - Adding a graph of new entities

如果创建多个新的关联实体，添加其中的一个到context会导致其它的也被添加。

在下面的例子中，blog和三个关联的post都会被插入到数据库。这些post被找到并添加，因为它们可以通过`Blog.Posts`导航属性获得。

```csharp
using (var context = new BloggingContext())
{
    var blog = new Blog
    {
        Url = "http://blogs.msdn.com/dotnet",
        Posts = new List<Post>
        {
            new Post { Title = "Intro to C#" },
            new Post { Title = "Intro to VB.NET" },
            new Post { Title = "Intro to F#" }
        }
    };

    context.Blogs.Add(blog);
    context.SaveChanges();
}
```

>**Tip**
>
>Add、Attach和Update方法都在传递给它们的实体的完整图上工作，如关联数据部分所述。此外, EntityEntry.State属性可用于仅设置单个实体的状态。例如：`context.Entry(blog).State = EntityState.Modified`。

##### 添加关联实体

如果从已经被context跟踪的实体的导航属性中引用一个新实体，那么该实体将会被发现，并插入到数据库中。

下面的例子中，`post`将会被插入到数据库，因为它被添加到从数据库拉取的`blog`的属性`Posts`。

```csharp
using (var context = new BloggingContext())
{
    var blog = context.Blogs.Include(b => b.Posts).First();
    var post = new Post { Title = "Intro to EF Core" };

    blog.Posts.Add(post);
    context.SaveChanges();
}
```

